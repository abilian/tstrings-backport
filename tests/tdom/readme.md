Copy-pasted from the tdom project.
